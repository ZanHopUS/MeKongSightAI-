<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Control - Mekong Sight</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            background: #333;
            color: white;
        }

        .control-panel {
            max-width: 500px;
            margin: 0 auto;
            background: #444;
            padding: 20px;
            border-radius: 15px;
        }

        h2 {
            text-align: center;
            color: #ff9800;
        }

        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        button {
            padding: 20px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            color: white;
            transition: transform 0.1s;
        }

        button:active {
            transform: scale(0.95);
        }

        .btn-safe {
            background: #2e7d32;
        }

        /* Xanh */
        .btn-danger {
            background: #c62828;
        }

        /* ƒê·ªè */
        .btn-warning {
            background: #f57f17;
            color: #000;
        }

        /* V√†ng */
        .btn-reset {
            background: #0277bd;
            grid-column: span 2;
        }

        /* Reset */

        .manual-input {
            background: #555;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        label {
            display: block;
            margin-top: 10px;
        }

        input[type=range] {
            width: 100%;
            height: 25px;
        }

        .status {
            text-align: center;
            margin-top: 15px;
            font-size: 14px;
            color: #aaa;
        }
    </style>
</head>

<body>

    <div class="control-panel">
        <h2>üéõÔ∏è B·ªò ƒêI·ªÄU KHI·ªÇN (GOD MODE)</h2>

        <div class="btn-grid">
            <button class="btn-safe" onclick="sendData(1.5, 30, 7.5)">‚úÖ B√åNH TH∆Ø·ªúNG</button>
            <button class="btn-danger" onclick="sendData(12.5, 36, 4.5)">üö® M·∫∂N CAO (ƒê·ªé)</button>
            <button class="btn-warning" onclick="sendData(3.5, 32, 6.5)">‚ö†Ô∏è CH·ªöM M·∫∂N (V√ÄNG)</button>
            <button class="btn-reset" onclick="sendData(0.5, 28, 8.0)">üåßÔ∏è SAU M∆ØA (NG·ªåT)</button>
        </div>

        <div class="manual-input">
            <h3>üéöÔ∏è K√©o th·ªß c√¥ng</h3>
            <label>ƒê·ªô m·∫∑n: <b id="lbl-sal">0</b>‚Ä∞</label>
            <input type="range" min="0" max="20" step="0.1" value="0" oninput="updateManual()" id="rng-sal">

            <label>Nhi·ªát ƒë·ªô: <b id="lbl-temp">30</b>¬∞C</label>
            <input type="range" min="20" max="40" step="0.5" value="30" oninput="updateManual()" id="rng-temp">
        </div>

        <p class="status" id="log">S·∫µn s√†ng...</p>
    </div>

    <script>
        // H√†m g·ª≠i d·ªØ li·ªáu l√™n Backend
        async function sendData(sal, temp, ph) {
            // C·∫≠p nh·∫≠t hi·ªÉn th·ªã thanh k√©o cho kh·ªõp
            document.getElementById('rng-sal').value = sal;
            document.getElementById('rng-temp').value = temp;
            updateLabels(sal, temp);

            const payload = {
                station_id: "ADMIN-01",
                salinity: parseFloat(sal),
                temperature: parseFloat(temp),
                ph: parseFloat(ph)
            };

            try {
                await fetch('/api/update-sensor', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                document.getElementById('log').innerText = `ƒê√£ g·ª≠i: M·∫∑n ${sal}‚Ä∞ - ${temp}¬∞C`;
                document.getElementById('log').style.color = "#4caf50";
            } catch (e) {
                document.getElementById('log').innerText = "‚ùå M·∫•t k·∫øt n·ªëi Server!";
                document.getElementById('log').style.color = "red";
            }
        }

        function updateManual() {
            const s = document.getElementById('rng-sal').value;
            const t = document.getElementById('rng-temp').value;
            updateLabels(s, t);
            // G·ª≠i d·ªØ li·ªáu li√™n t·ª•c khi k√©o (Real-time)
            sendData(s, t, 7.5);
        }

        function updateLabels(s, t) {
            document.getElementById('lbl-sal').innerText = s;
            document.getElementById('lbl-temp').innerText = t;
        }
    </script>

</body>

</html>