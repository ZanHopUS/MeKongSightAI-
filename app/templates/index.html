<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mekong Sight AI - N√¥ng nghi·ªáp 4.0</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    <!-- LOGIN SCREEN -->
    <div id="login-container" class="login-wrapper">
        <div class="login-content">
            <div class="brand-login">
                <i class="fas fa-leaf"></i> MEKONG SIGHT
            </div>
            <h2>ƒêƒÉng nh·∫≠p h·ªá th·ªëng</h2>
            <div class="form-group">
                <div class="input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" id="username" placeholder="T√™n t√†i kho·∫£n">
                </div>
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="password" placeholder="M·∫≠t kh·∫©u">
                </div>
                <div id="login-error" style="color:var(--danger); display:none; margin-bottom:15px;">
                    Sai th√¥ng tin ƒëƒÉng nh·∫≠p!
                </div>
                <button class="btn-primary" onclick="handleLogin()">Truy c·∫≠p ngay</button>
            </div>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="main-app" class="app-container" style="display: none;">

        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="user-avatar"><i class="fas fa-user-circle"></i></div>
                <div>
                    <h3 id="display-name">N√¥ng d√¢n</h3>
                    <span style="font-size:0.8rem; color:var(--success); font-weight:600;">
                        ‚óè ƒêang ho·∫°t ƒë·ªông
                    </span>
                </div>
            </div>
            <nav>
                <a href="#" class="nav-link active" onclick="switchPage('monitor')" id="nav-monitor">
                    <i class="fas fa-chart-pie"></i> Gi√°m s√°t
                </a>
                <a href="#" class="nav-link" onclick="switchPage('weather')" id="nav-weather">
                    <i class="fas fa-cloud-sun-rain"></i> Th·ªùi ti·∫øt & Tri·ªÅu
                </a>
                <a href="#" class="nav-link" onclick="switchPage('ai')" id="nav-ai">
                    <i class="fas fa-robot"></i> B√°c sƒ© AI
                </a>
                <a href="#" class="nav-link logout" onclick="handleLogout()">
                    <i class="fas fa-power-off"></i> ƒêƒÉng xu·∫•t
                </a>
            </nav>
        </aside>

        <!-- CONTENT AREA -->
        <main class="content-area">

            <!-- PAGE 1: GI√ÅM S√ÅT -->
            <section id="page-monitor" class="page-section active">

                <!-- Header -->
                <div class="monitor-header">
                    <div class="header-title">
                        <h2>T·ªïng quan M√¥i tr∆∞·ªùng</h2>
                        <span class="sub-text">
                            <i class="far fa-calendar-alt"></i>
                            <span id="current-date">--/--/--</span>
                        </span>
                    </div>

                    <div class="farming-selector">
                        <div class="control-item">
                            <label>V·ª• m√πa</label>
                            <select id="crop-type" onchange="updateVarieties()">
                                <option value="rice">üåæ L√∫a (M√πa m∆∞a)</option>
                                <option value="shrimp">ü¶ê T√¥m (M√πa kh√¥)</option>
                            </select>
                        </div>
                        <div class="control-item">
                            <label>Gi·ªëng lo√†i</label>
                            <select id="crop-variety" onchange="updateThresholds()"></select>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Grid: Gauge + Advice -->
                <div class="dashboard-grid">

                    <!-- Gauge Card -->
                    <div class="card gauge-card">
                        <div class="card-header-small">
                            <span>ƒê·ªò M·∫∂N TH·ª∞C T·∫æ</span>
                            <i class="fas fa-water" style="color:var(--secondary)"></i>
                        </div>

                        <div class="gauge-wrapper-clean">
                            <div class="gauge-arc-clean"></div>
                            <div class="gauge-needle-clean" id="gauge-needle"></div>
                        </div>

                        <div class="gauge-value-clean">
                            <span>
                                <span id="val-sal">0.0</span>
                                <small style="font-size:1.5rem">‚Ä∞</small>
                            </span>
                            <div class="gauge-unit">Ph·∫ßn ngh√¨n (ppt)</div>
                        </div>
                    </div>

                    <!-- Advice Card -->
                    <div class="card advice-card">
                        <div class="advice-header">
                            <div class="status-group">
                                <div class="status-indicator">
                                    <i id="status-icon" class="fas fa-sync fa-spin"></i>
                                </div>
                                <div class="status-info">
                                    <div class="status-label">T√åNH TR·∫†NG</div>
                                    <div id="status-text" class="status-text-large">ƒêang t·∫£i...</div>
                                </div>
                            </div>
                            <span class="model-tag" id="current-standard">Ti√™u chu·∫©n</span>
                        </div>

                        <div class="advice-content">
                            <div id="status-badge" class="status-badge-lg st-bg-green">
                                <i class="fas fa-sync fa-spin"></i>
                                <span>ƒêang ki·ªÉm tra...</span>
                            </div>
                            <ul id="advice-list">
                                <li>ƒêang ch·ªù d·ªØ li·ªáu c·∫£m bi·∫øn...</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Metrics Row -->
                <div class="metrics-row">
                    <div class="metric-box red">
                        <div class="metric-icon bg-red-light">
                            <i class="fas fa-temperature-high"></i>
                        </div>
                        <div class="metric-info">
                            <span class="metric-label">Nhi·ªát ƒë·ªô</span>
                            <span class="metric-val" id="val-temp">--</span>
                        </div>
                    </div>
                    <div class="metric-box purple">
                        <div class="metric-icon bg-purple-light">
                            <i class="fas fa-flask"></i>
                        </div>
                        <div class="metric-info">
                            <span class="metric-label">ƒê·ªô pH</span>
                            <span class="metric-val" id="val-ph">--</span>
                        </div>
                    </div>
                    <div class="metric-box blue">
                        <div class="metric-icon bg-blue-light">
                            <i class="fas fa-water"></i>
                        </div>
                        <div class="metric-info">
                            <span class="metric-label">M·ª±c n∆∞·ªõc</span>
                            <span class="metric-val" id="val-water">--</span>
                        </div>
                    </div>
                </div>

                <!-- Chart Card -->
                <div class="card chart-card">
                    <div class="card-header-small">
                        <span>PH√ÇN T√çCH XU H∆Ø·ªöNG ƒê·ªò M·∫∂N</span>
                        <div class="chart-opts">
                            <button onclick="changeRange('24h')" class="active">24H</button>
                            <button onclick="changeRange('7d')">7 Ng√†y</button>
                        </div>
                    </div>
                    <div class="chart-box">
                        <canvas id="salinityChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- PAGE 2: TH·ªúI TI·∫æT & TRI·ªÄU -->
            <section id="page-weather" class="page-section">
                <div class="monitor-header">
                    <div class="header-title">
                        <h2>Th·ªùi ti·∫øt & Th·ªßy tri·ªÅu</h2>
                        <span class="sub-text">D·ª± b√°o 7 ng√†y & L·ªãch s·ª≠ 30 ng√†y</span>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <!-- Weather Card -->
                    <div class="card" style="text-align:center; min-height:200px; justify-content:center;">
                        <i class="fas fa-sun" style="font-size:3.5rem; color:var(--accent); margin-bottom:15px;"></i>
                        <h1 id="weather-temp" style="font-size:3rem; margin:10px 0; font-weight:800;">--¬∞C</h1>
                        <p id="weather-desc" style="font-size:1.2rem; color:var(--text-muted); font-weight:600;">
                            ƒêang t·∫£i...
                        </p>
                    </div>

                    <!-- Tide Card -->
                    <div class="card" style="text-align:center; min-height:200px; justify-content:center;">
                        <i class="fas fa-water"
                            style="font-size:3.5rem; color:var(--secondary); margin-bottom:15px;"></i>
                        <h2 id="tide-level" style="font-size:2.5rem; margin:10px 0; font-weight:800;">--</h2>
                        <p id="tide-advice" style="font-weight:700; font-size:1.1rem; color:var(--primary);">
                            ƒêang t·∫£i...
                        </p>
                    </div>
                </div>

                <!-- Temperature Chart -->
                <div class="card chart-card" style="margin-top:20px;">
                    <div class="card-header-small">
                        <span>BI·ªÇU ƒê·ªí NHI·ªÜT ƒê·ªò (30 NG√ÄY + D·ª∞ B√ÅO 7 NG√ÄY)</span>
                        <i class="fas fa-temperature-high" style="color:var(--danger)"></i>
                    </div>
                    <div class="chart-box">
                        <canvas id="tempChart"></canvas>
                    </div>
                </div>

                <!-- Tide Chart -->
                <div class="card chart-card" style="margin-top:20px;">
                    <div class="card-header-small">
                        <span>D·ª∞ ƒêO√ÅN TH·ª¶Y TRI·ªÄU (37 NG√ÄY)</span>
                        <i class="fas fa-water" style="color:var(--info)"></i>
                    </div>
                    <div class="chart-box">
                        <canvas id="tideChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- PAGE 3: B√ÅC Sƒ® AI -->
            <section id="page-ai" class="page-section">
                <div class="monitor-header">
                    <div class="header-title">
                        <h2>B√°c sƒ© N√¥ng nghi·ªáp AI</h2>
                        <span class="sub-text">Ch·∫©n ƒëo√°n b·ªánh t·ª± ƒë·ªông b·∫±ng Gemini AI</span>
                    </div>
                </div>

                <div style="max-width:700px; margin:0 auto;">
                    <!-- Upload Section -->
                    <div class="card" style="text-align:center; padding:3rem;">
                        <div style="width:80px; height:80px; background:var(--primary-bg); border-radius:50%; 
                                    margin:0 auto 20px; display:flex; align-items:center; justify-content:center;">
                            <i class="fas fa-robot" style="font-size:40px; color:var(--primary);"></i>
                        </div>
                        <h3 style="font-size:1.5rem; margin-bottom:10px;">Ch·∫©n ƒëo√°n b·ªánh t·ª± ƒë·ªông</h3>
                        <p style="color:var(--text-muted); margin-bottom:2rem; line-height:1.6;">
                            Ch·ª•p ·∫£nh l√° l√∫a ho·∫∑c t√¥m ƒë·ªÉ AI ph√¢n t√≠ch ngay l·∫≠p t·ª©c.
                            H·ªá th·ªëng s·∫Ω nh·∫≠n di·ªán b·ªánh v√† ƒë·ªÅ xu·∫•t gi·∫£i ph√°p ƒëi·ªÅu tr·ªã.
                        </p>

                        <button class="btn-primary" onclick="document.getElementById('camera-input').click()" style="padding:15px 40px; font-size:1.1rem; border-radius:50px; display:inline-flex; 
                                       align-items:center; gap:10px;">
                            <i class="fas fa-camera"></i> Ch·ª•p ·∫£nh / T·∫£i l√™n
                        </button>
                        <input type="file" id="camera-input" accept="image/*" hidden onchange="uploadImage()">
                    </div>

                    <!-- AI Result -->
                    <div id="ai-result" class="card"
                        style="display:none; margin-top:20px; border-left:5px solid var(--primary);">
                        <img id="preview-img"
                            style="width:100%; border-radius:12px; margin-bottom:20px; box-shadow:var(--shadow-card);">

                        <h3 id="ai-status" style="color:var(--primary); font-size:1.3rem; margin-bottom:15px;">
                            ƒêang ph√¢n t√≠ch...
                        </h3>

                        <div class="solution-box">
                            <strong
                                style="display:flex; align-items:center; gap:8px; font-size:1.1rem; margin-bottom:10px;">
                                <i class="fas fa-user-md" style="color:var(--info);"></i>
                                L·ªùi khuy√™n ƒëi·ªÅu tr·ªã:
                            </strong>
                            <p id="ai-solution" style="margin-top:10px; line-height:1.7; color:var(--text-main);">
                                ƒêang ch·ªù k·∫øt qu·∫£...
                            </p>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <!-- MOBILE NAVIGATION -->
        <div class="mobile-nav">
            <div class="mobile-item active" onclick="switchPage('monitor')" id="mob-monitor">
                <i class="fas fa-chart-pie"></i>
            </div>
            <div class="mobile-item" onclick="switchPage('weather')" id="mob-weather">
                <i class="fas fa-cloud-sun"></i>
            </div>
            <div class="mobile-item center-btn" onclick="switchPage('ai')" id="mob-ai">
                <i class="fas fa-camera"></i>
            </div>
            <div class="mobile-item" onclick="handleLogout()">
                <i class="fas fa-sign-out-alt"></i>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/static/js/script.js"></script>
</body>

</html>